(check-expect (headed-by? test-train 'L) true)
(check-expect (headed-by? empty 'L) false)
(check-expect (headed-by? test-train 'B) false)
(check-expect (ends-with-caboose? test-train) true)
(check-expect (ends-with-caboose? empty) false)
(check-expect (ends-with-caboose? (cons (make-unit 'C 6) test-train)) false)
(check-expect (ends-with-caboose? (cons (make-unit 'C 1)
                                        (cons (make-unit 'B 2) empty))) false)
(define t1 (cons (make-unit 'L 1)
                 (cons (make-unit 'B 2)
                       (cons(make-unit 'T 3 ) empty))))
(check-expect (remove-unit test-train 3) (cons(make-unit 'L 2)
                                              (cons (make-unit 'C 5) empty)))
(check-expect (remove-unit empty 1) empty)
(check-expect (remove-unit t1 4) t1)
(check-expect (remove-unit t1 3) (cons (make-unit 'L 1)
                                       (cons(make-unit 'B 2) empty)))
(define improper-train1 (string->train "CL"))
(define improper-train2 (string->train "BL"))
(define improper-train3 (string->train "TL"))
(define improper-train4 (string->train "PL"))
(define proper-train1 (string->train "B"))
(define proper-train2 (string->train "LCC"))
(define proper-train3 (string->train "C"))
(define proper-train4 (string->train "T"))
(define proper-train5 (string->train "P"))
(define proper-train6 (string->train "L"))
(define complicated-train1 (string->train "LLTBPTTCCC"))
(define complicated-train2 (string->train "BLTPCCCCT"))
(check-expect (proper-train? test-train) true)
(check-expect (proper-train? empty) true)
(check-expect (proper-train? improper-train1) false)
(check-expect (proper-train? improper-train2) false)
(check-expect (proper-train? improper-train3) false)
(check-expect (proper-train? improper-train4) false)
(check-expect (proper-train? proper-train1) true)
(check-expect (proper-train? proper-train2) true)
(check-expect (proper-train? proper-train3) true)
(check-expect (proper-train? proper-train4) true)
(check-expect (proper-train? proper-train5) true)
(check-expect (proper-train? proper-train6) true)
(check-expect (proper-train? complicated-train1) true)
(check-expect (proper-train? complicated-train2) false)  